---
title: 【AWSクラウドプラクティショナー学習メモ】ストレージ系まとめ
tags:
  - Rails
  - S3
  - ActiveStorage
  - AWS認定クラウドプラクティショナー
private: false
updated_at: '2025-07-23T21:36:01+09:00'
id: 29f0429f400408152f52
organization_url_name: null
slide: false
ignorePublish: false
---
コンチには。miyoshiです。
今日はストレージについてまとめました。

>S3をよく聞くけど、何をするの？

深掘りする前に、まずは**サービスの大枠** の理解から入っていきます。
僕にとっての学習メモですが、同様にAWS学習者とこの記事を共有できたらと思います。

## ✅ AWSでストレージを選ぶフローチャート
```
何を保存・管理したい？
│
├─ ✅「アプリやOSで使うディスクが欲しい」→ **EBS（ブロックストレージ）**
│     ├─ EC2インスタンス専用ディスク
│     ├─ OS / DBなど高性能I/O向き
│     └─ キーワード：「EC2用のHDD/SSD」
│
├─ ✅「複数サーバーで同時にファイル共有したい」
│     │
│     ├─ 「Linux環境」→ **EFS（ファイルストレージ）**
│     │     ├─ NFS互換、複数EC2から同時アクセス
│     │     └─ キーワード：「Linuxの共有ディレクトリ」
│     │
│     └─ 「Windows環境 or 特定用途」
│           ├─ **FSx for Windows File Server**（SMB共有）
│           └─ **FSx for Lustre**（HPCや高性能演算向き）
│
├─ ✅「大量データを安価に保存したい（アーカイブ用途）」
│     │
│     ├─ 「すぐに取り出したい」→ **S3 Standard / S3 Standard-IA**
│     │     └─ キーワード：「汎用オブジェクトストレージ」
│     │
│     └─ 「ほとんど使わない長期保存」→ **S3 Glacier / Glacier Deep Archive**
│           ├─ 超低コスト
│           └─ 復元に数時間かかる
│
├─ ✅「オンプレとAWS間でデータ連携したい」→ **AWS Storage Gateway**
│     ├─ オンプレからS3/EBSへバックアップ
│     └─ キーワード：「ハイブリッド構成」
│
├─ ✅「大量データを物理的にAWSへ移行したい」→ **Snow Family**
│     ├─ **Snowcone**（小規模データ用・小型）
│     ├─ **Snowball**（数十TB～数PBのデータ移行）
│     └─ **Snowmobile**（エクサバイト級・トラック輸送）
│
└─ ✅「AWS全体のバックアップをまとめて管理したい」→ **AWS Backup**
      ├─ EBS / RDS / DynamoDB / EFS / FSxなど対象
      ├─ バックアップポリシー・スケジュールを一元管理
      └─ キーワード：「バックアップ統合管理」
```
## ✅ S3ストレージクラス選び方フローチャート
```
S3に保存したいデータは？
│
├─ 📌「頻繁にアクセスする」→ **S3 Standard**
│     ├─ デフォルト
│     ├─ 高耐久・高可用性
│     └─ キーワード：「日常的に使うデータ」
│
├─ 📌「アクセス頻度は低いが、必要な時はすぐ取得したい」
│     │
│     ├─ 「リージョン冗長が必要」→ **S3 Standard-IA（低頻度アクセス）**
│     │     ├─ 30日以上保存するデータに最適
│     │     └─ キーワード：「たまにアクセスするけど重要」
│     │
│     └─ 「リージョン冗長が不要」→ **S3 One Zone-IA**
│           ├─ 1つのAZのみで管理
│           └─ キーワード：「災害対策不要・コスト重視」
│
└─ 📌「ほとんどアクセスしない（アーカイブ用）」
      │
      ├─ 「数時間で復元できれば良い」→ **S3 Glacier Flexible Retrieval**
      │     └─ キーワード：「バックアップ・災害復旧用」
      │
      └─ 「取り出しは滅多にない＆復元に12時間以上かかっても良い」
            → **S3 Glacier Deep Archive**
            └─ キーワード：「長期保管（法的記録など）」
```
## ✅ ここで気になることがある！！！
>S3はデータベースではないの？？

### ✅ 結論
**S3はデータベースではなく「オブジェクトストレージ」です。**  
MySQLのようなリレーショナルデータベース（RDBMS）とは役割がまったく異なります。


## ✅ S3とMySQLの違い

| 比較項目 | S3（Simple Storage Service） | MySQL（RDBMS） |
| -------- | ----------------------------- | -------------- |
| **役割** | オブジェクト（ファイル）の保存 | 構造化データ（表形式）の保存・操作 |
| **保存するもの** | 画像、動画、PDF、バックアップなどのファイル | ユーザー情報、売上データなどの構造化データ |
| **データ構造** | フラットなオブジェクト＋メタデータ（バケット内に格納） | テーブル、カラム、行といったリレーショナル構造 |
| **検索方法** | オブジェクト名やキーで取得（SQLは使えない） | SQLで条件検索や集計が可能 |
| **利用用途** | バックアップ、静的Webホスティング、ログ保存、ビッグデータの格納 | アプリケーションのデータ管理、トランザクション処理 |
| **スケーリング** | 自動で大容量対応（ペタバイト級） | 水平スケーリングは工夫が必要 |
| **整合性** | 最終的整合性（ただし新しい書き込みは強い整合性に対応済み） | 強い整合性 |


## ✅ なぜS3はデータベースではないのか？

S3は単なる「ファイル置き場」であり、  
データを検索・結合・集計する機能（SQL的な操作）は基本的に持たないためです。

ただし、**Athena（S3上のデータにSQLクエリを実行できるサービス）** を組み合わせると、  
S3をデータレイク的に扱うことは可能です。


## 🔹 例えるならば・・・

- **S3** → 倉庫（物を置く場所、整理はできるが中身を並べ替えたりはできない）  
- **MySQL** → 図書館の司書システム（本をきちんと棚に分類し、すぐに検索・集計できる）

## ✅ ここで気になることがある！！！
>railsで言うところの、Active Storage？？
## ✅ 結論
S3自体はRailsのActive Storageが直接提供する機能とは違いますが、役割的には「Active Storageの保存先」としてよく使われます。

```
ユーザーが画像アップロード
     ↓
Active Storageがアップロード処理を管理
     ↓
S3に実際のファイルが保存される
     ↓
Active StorageはDBにファイルのパス情報などを保存
```
### ✅ Active Storage × S3 連携フローチャート
```
ユーザーがフォームから画像アップロード
        ↓
Railsコントローラがリクエストを受け取る（`params`に添付ファイル情報）
        ↓
Active Storageがファイルのアップロード処理を実行
        ↓
【保存先設定をチェック】
        ├─ development/test環境 → ローカルディスクに保存
        └─ production環境 → S3に直接アップロード
                ↓
S3バケットにファイル（オブジェクト）が保存される
        ↓
Active StorageがDB（`active_storage_blobs`テーブル）に
ファイルのメタデータ（ファイル名、キー、コンテンツタイプなど）を記録
        ↓
ビューで`image_tag user.avatar`など呼び出すと
Active StorageがS3のURLを生成し、ユーザーに画像を表示
```

次は「EC２」についてまとめます。

今日もコツコツ学習していきます。
